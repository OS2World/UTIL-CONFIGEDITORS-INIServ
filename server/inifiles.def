DEFINITION MODULE INIFiles;

        (********************************************************)
        (*                                                      *)
        (*          File operations for INIServe                *)
        (*                                                      *)
        (*  Programmer:         P. Moylan                       *)
        (*  Started:            30 May 1998                     *)
        (*  Last edited:        21 July 2015                    *)
        (*  Status:             OK                              *)
        (*                                                      *)
        (********************************************************)


FROM Sockets IMPORT
    (* type *)  Socket;

TYPE FilenameString = ARRAY [0..511] OF CHAR;

PROCEDURE ListDrives (S: Socket);

    (* Sends a list of drive names to socket S.  We send one name per line.     *)

PROCEDURE ListDirectory (S: Socket;  Mask: ARRAY OF CHAR);

    (* Sends a list of all files matching mask to socket S.  (If Mask ends with *)
    (* a '\' or '/', we list all files in the directory whose name is in Mask.) *)
    (* We send one name per line.                                               *)

PROCEDURE MakeFilename (VAR (*IN*) CurrentDir: FilenameString;
                        VAR (*IN*) newdir: ARRAY OF CHAR;
                        VAR (*OUT*) result: FilenameString;
                        VAR (*OUT*) AtRoot: BOOLEAN);

    (* If newdir is an absolute path, it replaces result.  If it's      *)
    (* a relative path, result is the concatenation of CurrentDir and   *)
    (* newdir.  In either case, AtRoot is set TRUE iff this puts us at  *)
    (* the root of the directory tree.                                  *)

PROCEDURE SetDirectory (VAR (*INOUT*) CurrentDir: FilenameString;
                        VAR (*IN*) newdir: ARRAY OF CHAR;
                        VAR (*OUT*) AtRoot: BOOLEAN): BOOLEAN;

    (* If newdir is an absolute path, it replaces CurrentDir.  If it's  *)
    (* a relative path, it's used to update CurrentDir.  In either      *)
    (* case, AtRoot is set TRUE iff this puts us at the root of the     *)
    (* directory tree.                                                  *)

PROCEDURE MakeDirectory (VAR (*IN*) CurrentDir: FilenameString;
                         VAR (*IN*) newdir: ARRAY OF CHAR): BOOLEAN;

    (* Creates a new directory.  The newdir parameter can specify       *)
    (* either an absolute path or a relative path.                      *)

PROCEDURE MoveFile (VAR (*IN*) CurrentDir: FilenameString;
                         VAR (*IN*) src, dst: ARRAY OF CHAR): BOOLEAN;

    (* Moves a file or directory.  The src and dst parameters can       *)
    (* specify either an absolute path or a relative path.              *)

PROCEDURE FileDelete (VAR (*IN*) CurrentDir: FilenameString;
                         VAR (*IN*) name: ARRAY OF CHAR): BOOLEAN;

    (* Deletes a file or directory.  The name parameter can specify     *)
    (* either an absolute path or a relative path.  Trying to delete a  *)
    (* nonexistent file is OK.  Trying to delete a nonempty directory   *)
    (* is not OK, and will give a FALSE result.                         *)

END INIFiles.

